"use strict";var _slicedToArray=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var t=[],i=!0,n=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(t.push(o.value),!r||t.length!==r);i=!0);}catch(e){n=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw s}}return t}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(r,t,i){return t&&e(r.prototype,t),i&&e(r,i),r}}(),_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var OdiaKeyboardDriver=function(){var e,r,t,i,n=9,s=32,o=48,a=49,h=50,p=51,v=52,d=53,f=54,y=55,l=56,c=57,u=58,P=94,C=96,_=65,g=67,b=68,k=69,m=71,w=72,K=73,x=74,A=76,L=77,O=78,S=79,T=81,E=82,N=83,R=84,j=85,V=86,D=87,I=89,q=97,M=98,Q=99,U=100,z=101,B=102,F=103,G=104,H=105,J=106,W=107,X=108,Y=109,Z=110,$=111,ee=112,re=113,te=114,ie=115,ne=116,se=117,oe=118,ae=119,he=120,pe=121,ve=122,de=1,fe=4,ye=5,le=(_defineProperty(e={},s," "),_defineProperty(e,u,"ଃ"),_defineProperty(e,P,"ଁ"),_defineProperty(e,L,"ଂ"),_defineProperty(e,C,"୍"),_defineProperty(e,k,"ଽ"),_defineProperty(e,V,"୰"),_defineProperty(e,T,"ॐ"),_defineProperty(e,re,"₹"),_defineProperty(e,de,"୍"),_defineProperty(e,fe,"‍"),_defineProperty(e,ye,"‌"),e),ce=(_defineProperty(r={},o,"୦"),_defineProperty(r,a,"୧"),_defineProperty(r,h,"୨"),_defineProperty(r,p,"୩"),_defineProperty(r,v,"୪"),_defineProperty(r,d,"୫"),_defineProperty(r,f,"୬"),_defineProperty(r,y,"୭"),_defineProperty(r,l,"୮"),_defineProperty(r,c,"୯"),r),ue=(_defineProperty(t={},q,"ଅ"),_defineProperty(t,_,"ଆ"),_defineProperty(t,H,"ଇ"),_defineProperty(t,K,"ଈ"),_defineProperty(t,se,"ଉ"),_defineProperty(t,j,"ଊ"),_defineProperty(t,E,"ଋ"),_defineProperty(t,S,"ଌ"),_defineProperty(t,z,"ଏ"),_defineProperty(t,$,"ଓ"),t),Pe=[[q,q,"ଆ"],[z,z,"ଈ"],[$,$,"ଊ"],[E,j,"ୠ"],[q,H,"ଐ"],[q,se,"ଔ"]],Ce=_extends({},le,(_defineProperty(i={},W,"କ"),_defineProperty(i,F,"ଗ"),_defineProperty(i,Q,"ଚ"),_defineProperty(i,g,"ଛ"),_defineProperty(i,J,"ଜ"),_defineProperty(i,ve,"ଝ"),_defineProperty(i,R,"ଟ"),_defineProperty(i,b,"ଡ"),_defineProperty(i,O,"ଣ"),_defineProperty(i,ne,"ତ"),_defineProperty(i,U,"ଦ"),_defineProperty(i,Z,"ନ"),_defineProperty(i,ee,"ପ"),_defineProperty(i,B,"ଫ"),_defineProperty(i,M,"ବ"),_defineProperty(i,oe,"ଭ"),_defineProperty(i,Y,"ମ"),_defineProperty(i,pe,"ଯ"),_defineProperty(i,te,"ର"),_defineProperty(i,X,"ଲ"),_defineProperty(i,A,"ଳ"),_defineProperty(i,ae,"ଵ"),_defineProperty(i,D,"ୱ"),_defineProperty(i,ie,"ସ"),_defineProperty(i,N,"ଷ"),_defineProperty(i,he,"କ୍ଷ"),_defineProperty(i,G,"ହ"),_defineProperty(i,I,"ୟ"),_defineProperty(i,q,""),_defineProperty(i,_,"ା"),_defineProperty(i,H,"ି"),_defineProperty(i,K,"ୀ"),_defineProperty(i,se,"ୁ"),_defineProperty(i,j,"ୂ"),_defineProperty(i,z,"େ"),_defineProperty(i,S,"ୢ"),_defineProperty(i,$,"ୋ"),_defineProperty(i,E,"ୃ"),i)),_e=[[W,G,"ଖ"],[F,G,"ଘ"],[Q,G,"ଚ"],[g,G,"ଛ"],[J,G,"ଝ"],[R,G,"ଠ"],[b,G,"ଢ"],[ne,G,"ଥ"],[U,G,"ଧ"],[ee,G,"ଫ"],[M,G,"ଭ"],[ie,G,"ଶ"],[N,G,"ଷ"],[q,q,"ା"],[z,z,"ୀ"],[$,$,"ୂ"],[q,H,"ୈ"],[q,se,"ୌ"],[E,j,"ୃ"],[O,m,"ଙ"],[O,I,"ଞ"],[b,b,"ଡ଼"],[b,w,"ଢ଼"],[x,Z,"ଜ୍ଞ"]],ge=function(){function e(){_classCallCheck(this,e),this.isNative=!1,this.reset()}return _createClass(e,[{key:"reset",value:function(){this.prevKey=s,this.prevCons=!1,this.prevPrevCons=!1,this.hidden=!1,this.posChanged=!0}},{key:"toggleLang",value:function(){return this.reset(),this.isNative=!this.isNative,this.isNative?"native":"odia"}},{key:"input",value:function(e){var r=[0,e];if(this.isNative)return r;var t=0,i="",n=e.charCodeAt(0);if(!this.isAllowedKey(n))return this.reset(),r;this.posChanged&&(this.prevKey=s,this.hidden=!1,this.prevCons=!1,this.prevPrevCons=!1);var o=void 0,a=void 0;switch(e){case"a":o=this.getConsonantCombination(this.prevKey,n),a=this.getVowelCombination(this.prevKey,n),this.prevCons?(t=0,i=Ce[n]):a?this.prevPrevCons?(t=0,i=o):(t-=1,i=a):(t=0,i=ue[n]),this.prevPrevCons=this.prevCons,this.prevCons=!1,this.hidden=!1;break;case"e":case"i":case"o":case"u":case"A":case"I":case"O":case"U":o=this.getConsonantCombination(this.prevKey,n),a=this.getVowelCombination(this.prevKey,n),this.prevCons?(t=0,i=Ce[n]):a?this.prevPrevCons?(t=this.prevKey===n?t-1:0,i=o):(t-=1,i=a):(t=0,i=ue[n]),this.prevPrevCons=this.prevCons,this.prevCons=!1,this.hidden=!1;break;case"R":t=0,i=this.prevCons?Ce[n]:ue[n],this.prevPrevCons=this.prevCons,this.prevCons=!1,this.hidden=!1;break;case"M":case"^":case":":case"E":case"V":case"q":case"Q":i=Ce[n],this.prevPrevCons=this.prevCons,this.prevCons=!1,this.hidden=!1;break;case"`":i=this.prevCons?Ce[de]:"`",this.prevPrevCons=this.prevCons,this.prevCons=!1,this.hidden=!1;break;case"~":i=this.prevCons?Ce[de]+Ce[ye]:"~",this.prevPrevCons=this.prevCons,this.prevCons=!1,this.hidden=!1;break;case" ":t=0,i=" ",this.prevPrevCons=!1,this.prevCons=!1,this.hidden=!1;break;default:o=this.getConsonantCombination(this.prevKey,n),this.hidden?o?(t=0,i=this.prevPrevCons?Ce[de]+o:o,this.reset(),this.prevPrevCons=!1,this.prevCons=!0):Ce[n]?(t=0,i=this.prevCons&&!this.prevPrevCons?Ce[de]+Ce[n]:Ce[n],this.reset(),this.prevPrevCons=this.prevCons,this.prevCons=!0,this.hidden=!1):(t=0,this.prevPrevCons=this.prevCons,this.prevCons=!1):o?(t-=1,i=o,this.reset(),this.prevPrevCons=!1,this.prevCons=!0):Ce[n]?(t=0,i=this.prevCons&&!this.prevPrevCons?Ce[de]+Ce[n]:Ce[n],this.reset(),this.prevPrevCons=this.prevCons,this.prevCons=!0):ce[n]?(t=0,i=ce[n],this.prevPrevCons=this.prevCons,this.prevCons=!1):(this.prevPrevCons=this.prevCons,this.prevCons=!0,this.hidden=!0)}return this.prevKey=n,this.posChanged=!1,[t,i]}},{key:"isAllowedKey",value:function(e){return!(e<32||e>=33&&e<=47||e>=59&&e<=64||e>=91&&e<=93||95===e||e>=123&&e<=125||e>=127)}},{key:"getVowelCombination",value:function(e,r){var t=!0,i=!1,n=void 0;try{for(var s,o=Pe[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var a=s.value;if(a[0]===e&&a[1]===r)return a[2]}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}}},{key:"getConsonantCombination",value:function(e,r){var t=!0,i=!1,n=void 0;try{for(var s,o=_e[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var a=s.value;if(a[0]===e&&a[1]===r)return a[2]}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}}}]),e}(),be=function(){return!0},ke=function(){function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:be;_classCallCheck(this,e),this.el=r,this.fsm=new ge,this.onChange=function(e){return t(e)},this.onLangChange=function(e){return i(e)},this.init()}return _createClass(e,[{key:"init",value:function(){var e=this;document.body.addEventListener("keydown",(function(r){if(e.el.contains(r.target)&&r.keyCode===n)return r.preventDefault(),void e.toggleLang()})),this.el.addEventListener("keypress",this.handleKeyPress.bind(this)),this.el.addEventListener("keyup",this.changeCursor.bind(this))}},{key:"toggleLang",value:function(){var e=this.fsm.toggleLang();this.onLangChange(e)}},{key:"handleKeyPress",value:function(e){this.isNative||this.modify(e),this.onChange(this.el.value)}},{key:"changeCursor",value:function(){this.el.createTextRange&&(this.el.cursorPos=document.selection.createRange().duplicate()),0===this.el.value.length&&this.fsm.reset()}},{key:"modify",value:function(e){if(e.altKey||e.ctrlKey)return!0;e.preventDefault();var r=document.all?e.keyCode:e.which,t=String.fromCharCode(r),i=this.fsm.input(t),n=_slicedToArray(i,2),s=n[0],o=n[1],a=this.el.value,h=a.length;if(this.el.setSelectionRange){var p=this.el.selectionStart,v=a.substring(0,p+s),d=a.substring(p,h),f=this.el.scrollTop,y=void 0!==o?p+s+o.length:p+s;this.el.value=v+o+d,this.el.scrollTop=f,this.el.focus(),this.el.setSelectionRange(y,y)}else if(this.el.createTextRange&&this.el.cursorPos){var l=this.el.cursorPos;l.moveStart("character",s),l.text=" "===l.text.charAt(l.text.length-1)?o+" ":o,l.collapse(!1),l.scrollIntoView(!0)}else 0===s?this.el.value+=o:this.el.value=a.substring(0,h-1)+o;return this.el.focus(),!1}}]),e}();return window.OdiaKeyboardDriver=ke,ke}();